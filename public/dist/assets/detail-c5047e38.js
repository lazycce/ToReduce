import{d as e,a as t,c as a,e as l,M as n,_ as s,r,q as i,w as o,b as c,g as d,C as h,t as u,O as v,P as p,H as w,o as m,Q as f,R as y,p as k,S as x,i as g,f as _,k as C,n as z,m as I,T as b}from"./index-e19c5bd5.js";const M={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},E=[l("circle",{cx:"256",cy:"256",r:"64",fill:"currentColor"},null,-1),l("path",{d:"M490.84 238.6c-26.46-40.92-60.79-75.68-99.27-100.53C349 110.55 302 96 255.66 96c-42.52 0-84.33 12.15-124.27 36.11c-40.73 24.43-77.63 60.12-109.68 106.07a31.92 31.92 0 0 0-.64 35.54c26.41 41.33 60.4 76.14 98.28 100.65C162 402 207.9 416 255.66 416c46.71 0 93.81-14.43 136.2-41.72c38.46-24.77 72.72-59.66 99.08-100.92a32.2 32.2 0 0 0-.1-34.76zM256 352a96 96 0 1 1 96-96a96.11 96.11 0 0 1-96 96z",fill:"currentColor"},null,-1)],L=e({name:"Eye",render:function(e,l){return t(),a("svg",M,E)}}),S={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 512 512"},B=[n('<path d="M64 480H48a32 32 0 0 1-32-32V112a32 32 0 0 1 32-32h16a32 32 0 0 1 32 32v336a32 32 0 0 1-32 32z" fill="currentColor"></path><path d="M240 176a32 32 0 0 0-32-32h-64a32 32 0 0 0-32 32v28a4 4 0 0 0 4 4h120a4 4 0 0 0 4-4z" fill="currentColor"></path><path d="M112 448a32 32 0 0 0 32 32h64a32 32 0 0 0 32-32v-30a2 2 0 0 0-2-2H114a2 2 0 0 0-2 2z" fill="currentColor"></path><rect x="112" y="240" width="128" height="144" rx="2" ry="2" fill="currentColor"></rect><path d="M320 480h-32a32 32 0 0 1-32-32V64a32 32 0 0 1 32-32h32a32 32 0 0 1 32 32v384a32 32 0 0 1-32 32z" fill="currentColor"></path><path d="M495.89 445.45l-32.23-340c-1.48-15.65-16.94-27-34.53-25.31l-31.85 3c-17.59 1.67-30.65 15.71-29.17 31.36l32.23 340c1.48 15.65 16.94 27 34.53 25.31l31.85-3c17.59-1.67 30.65-15.71 29.17-31.36z" fill="currentColor"></path>',6)],D=e({name:"Library",render:function(e,l){return t(),a("svg",S,B)}}),H=["onClick"],N=s({__name:"ChaptersDrawer",props:{chapterList:{type:Array,default:()=>[]}},emits:"select",setup(e,{expose:a,emit:n}){const s=n,w=r(!1);return a({show:()=>{w.value=!0}}),(a,n)=>(t(),i(d(p),{show:w.value,"onUpdate:show":n[0]||(n[0]=e=>w.value=e),placement:"bottom"},{default:o((()=>[c(d(v),{title:"章节"},{default:o((()=>[c(d(h),{"item-size":24,items:e.chapterList},{default:o((({item:e})=>[l("div",{class:"item",onClick:t=>(e=>{s("select",e),w.value=!1})(e)},u(e),9,H)])),_:1},8,["items"])])),_:1})])),_:1},8,["show"]))}},[["__scopeId","data-v-b934beb3"]]),V={style:{height:"100%"}},q={class:"content"},O=["id"],R=s({__name:"detail",setup(e){const n=r(""),s=r([]),i=r([]),h=w(),v=r({});m((()=>{v.value=JSON.parse(h.query.data),(async e=>{const t=await g.invoke(_.getNovelDetail,{novelId:e});t&&t.length>0&&(n.value=t[0].content,i.value=(e=>{const t=/(第[一二三四五六七八九十百千零\d]+章\s*[^\n]*)/g,a=[];let l;for(;null!==(l=t.exec(e));)a.push({key:l[0].trim(),startIndex:l.index});const n=[];for(let s=0;s<a.length;s++){const t=a[s],l=a[s+1],r=e.slice(t.startIndex+t.key.length,l?l.startIndex:void 0).trim();n.push({key:t.key,content:r})}return n})(n.value),s.value=i.value.map((e=>e.key)))})(v.value.id)}));const p=e=>{"Escape"===e.key&&(g.invoke(_.setWindowSize,{width:750,height:470}),E.value=!0)};f((()=>{window.addEventListener("keydown",p)})),y((()=>{window.removeEventListener("keydown",p)}));const M=e=>{const t=document.getElementById(e);null==t||t.scrollIntoView({behavior:"smooth"})},E=r(!0),S=r();return(e,n)=>{const r=k("NIcon"),h=k("TitleBar");return t(),a("div",V,[c(h,{hidden:!E.value},{"right-action":o((()=>[c(r,{title:"章节选择",size:22,onClick:n[0]||(n[0]=e=>{S.value.show()})},{default:o((()=>[c(d(D))])),_:1}),c(r,{title:"专注模式",size:22,onClick:n[1]||(n[1]=e=>(g.invoke(_.setWindowSize,{width:300,height:200}),void(E.value=!1)))},{default:o((()=>[c(d(L))])),_:1})])),_:1},8,["hidden"]),c(d(b),{class:"read-wrapper",style:x({height:E.value?"calc(100% - 42px)":"100%"})},{default:o((()=>[l("pre",q,[n[3]||(n[3]=C("          ")),(t(!0),a(z,null,I(i.value,(e=>(t(),a("div",{id:e.key},[n[2]||(n[2]=C("\n            ")),l("div",null,u(e.key),1),C("\n            "+u(e.content)+"\n          ",1)],8,O)))),256)),n[4]||(n[4]=C("\n        "))])])),_:1},8,["style"]),c(N,{"chapter-list":s.value,ref_key:"chaptersDrawerRef",ref:S,onSelect:M},null,8,["chapter-list"])])}}},[["__scopeId","data-v-bc984df8"]]);export{R as default};
